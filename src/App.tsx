import React, { useEffect, useState, useMemo } from "react";

import "./App.css";
import moment from "moment";

const DAY = 24;
const MINUT = 60;
const S = 1000;

const App: React.FC = () => {
  const NEW_YEAR = useMemo(() => moment("01/01/2022"), []);
  const [now, setNow] = useState(moment());
  const [time, setTime] = useState<[number, number, number, number]>([
    0, 0, 0, 0,
  ]);
  const [isNewYear, setIsNewYear] = useState(false);

  useEffect(() => {
    setInterval(() => {
      setNow(moment());
      const NOW = moment();
      const d = NEW_YEAR.diff(NOW, "days");
      const h = NEW_YEAR.diff(NOW, "hours") - d * DAY;
      const m = NEW_YEAR.diff(NOW, "minutes") - d * DAY * MINUT - h * MINUT;
      const s =
        NEW_YEAR.diff(NOW, "seconds") - NEW_YEAR.diff(NOW, "minutes") * 60;
      setTime([d, h, m, s]);
      if (NEW_YEAR.diff(NOW, "seconds") < 0) {
        setIsNewYear(true);
      }
    }, S);
  }, [NEW_YEAR]);

  function str(count: number, one: string, two: string, five: string) {
    return count % 10 === 1 && count % 100 !== 11
      ? one
      : count % 10 >= 2 &&
        count % 10 <= 4 &&
        (count % 100 < 10 || count % 100 >= 20)
      ? two
      : five;
  }

  return (
    <div className="App">
      <div className="content">
        <div className="logo">
          <svg
            width="250"
            height="47"
            viewBox="0 0 158 30"
            fill="none"
            xmlns="http://www.w3.org/2000/svg"
          >
            <path
              d="M26.0887 28.5682C24.7487 29.1355 23.4049 29.612 22.0716 30L36.7985 10.0081H26.494L24.6778 12.4736C24.4602 11.7877 24.0783 11.1731 23.5214 10.6505C19.9449 7.29391 10.5089 9.00202 2.44535 14.4656C1.57782 15.0535 0.76154 15.6608 0 16.2808C2.13915 11.0769 7.64958 5.88606 15.1031 2.73054C26.6213 -2.14587 38.4179 -0.314936 41.4516 6.81986C44.4852 13.9547 37.607 23.6919 26.0887 28.5682Z"
              fill="#ffffff"
            />
            <path
              d="M3.14805 28.4089C4.97861 30.2041 9.73052 29.373 13.7616 26.5528C17.7928 23.7325 19.5768 19.991 17.7463 18.1958C15.9158 16.4007 11.1639 17.2316 7.13275 20.0519C3.10154 22.8721 1.31757 26.6137 3.14805 28.4089Z"
              fill="#ffffff"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M61.6891 10.0165H57.1016V11.2686C56.1431 10.1405 54.5814 9.58918 53.0948 9.58918C49.2619 9.58918 46.6172 12.7478 46.6172 16.4339C46.6172 20.12 49.3144 23.3055 53.1443 23.3055C54.6564 23.3055 56.2451 22.7288 57.0506 21.4498H57.1016V22.8797H61.6891V10.0165ZM54.3039 13.5517C56.1686 13.5517 57.2532 14.88 57.2532 16.4608C57.2532 18.0894 56.1686 19.3445 54.3039 19.3445C52.4392 19.3445 51.3546 18.0894 51.3546 16.4608C51.3546 14.88 52.4392 13.5517 54.3039 13.5517Z"
              fill="#ffffff"
            />
            <path
              d="M69.2486 10.0191V16.8892C69.2486 18.5179 69.6506 19.6713 71.5423 19.6713C73.431 19.6713 73.8345 18.5179 73.8345 16.8892V10.0191H78.4219V17.7678C78.4219 22.0037 75.4216 23.3081 71.5423 23.3081C67.6599 23.3081 64.6597 22.0037 64.6597 17.7678V10.0191H69.2486Z"
              fill="#ffffff"
            />
            <path
              d="M85.99 12.1219H85.939V10.0166H81.3531V22.8798H85.939V17.6876C85.939 15.4823 86.5706 13.8013 89.1148 13.8013C89.8214 13.8013 90.4259 13.876 91.056 14.2287V9.84033H90.1739C88.3842 9.84033 86.8736 10.5411 85.99 12.1219Z"
              fill="#ffffff"
            />
            <path
              d="M98.0904 10.0147H93.5045V22.8779H98.0904V10.0147Z"
              fill="#ffffff"
            />
            <path
              d="M98.364 5.07606C98.364 6.47908 97.2044 7.63406 95.7942 7.63406C94.3826 7.63406 93.223 6.47908 93.223 5.07606C93.223 3.67156 94.3826 2.51807 95.7942 2.51807C97.2044 2.51807 98.364 3.67156 98.364 5.07606Z"
              fill="#ffffff"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M153.411 10.0165H158V22.8797H153.411V21.4498H153.362C152.555 22.7288 150.968 23.3055 149.455 23.3055C145.624 23.3055 142.928 20.12 142.928 16.4339C142.928 12.7478 145.573 9.58917 149.406 9.58917C150.891 9.58917 152.454 10.1405 153.411 11.2686V10.0165ZM153.563 16.4608C153.563 14.88 152.48 13.5517 150.615 13.5517C148.749 13.5517 147.666 14.88 147.666 16.4608C147.666 18.0894 148.749 19.3445 150.615 19.3445C152.48 19.3445 153.563 18.0894 153.563 16.4608Z"
              fill="#ffffff"
            />
            <path
              fill-rule="evenodd"
              clip-rule="evenodd"
              d="M111.147 10.0165H115.736V21.6246C115.736 27.0917 113.013 29.2986 108.249 29.2986C105.275 29.2986 101.294 27.7701 100.89 24.3828H106.031C106.157 24.8356 106.484 25.1613 106.888 25.3615C107.292 25.5617 107.77 25.6633 108.199 25.6633C110.668 25.6633 111.147 24.0586 111.147 21.9772V21.3751C109.963 22.554 108.753 23.1307 107.04 23.1307C103.258 23.1307 100.664 20.2709 100.664 16.5594C100.664 12.7986 103.334 9.58918 107.292 9.58918C108.804 9.58918 110.19 10.0912 111.097 11.3687H111.147V10.0165ZM111.3 16.3592C111.3 14.7799 110.215 13.4501 108.351 13.4501C106.484 13.4501 105.4 14.7799 105.4 16.3592C105.4 17.9893 106.484 19.2429 108.351 19.2429C110.215 19.2429 111.3 17.9893 111.3 16.3592Z"
              fill="#ffffff"
            />
            <path
              d="M123.301 11.6197H123.351C124.437 10.1913 125.772 9.58917 127.436 9.58917C129.3 9.58917 130.913 10.3407 131.846 12.0471C132.728 10.4408 134.467 9.58917 136.233 9.58917C139.507 9.58917 140.643 11.7198 140.643 14.6783V22.8797H136.056V16.6371C136.057 15.3013 136.059 13.2245 134.165 13.2245C132.047 13.2245 131.971 15.2057 131.971 16.7357V22.8797H127.386V16.7357C127.386 15.3058 127.386 13.1258 125.343 13.1258C123.301 13.1258 123.301 15.3058 123.301 16.7357V22.8797H118.715V10.0165H123.301V11.6197Z"
              fill="#ffffff"
            />
          </svg>
        </div>
        {isNewYear ? (
          <>
            <h1>С Новым 2020 годом!</h1>
          </>
        ) : (
          <>
            <h1>
              С наступающим <br />
              Новым годом!
            </h1>
            {/* <div className="now">Сегодня: {now.format("DD/MM/YYYY")}.</div> */}
            <div className="left">До Нового года осталось:</div>
            <div className="left-days">
              {time[0]} {str(time[0], "день", "дня", "дней")}, {time[1]}{" "}
              {str(time[1], "час", "часа", "часов")} <br /> {time[2]}{" "}
              {str(time[2], "минута", "минуты", "минут")}, {time[3]}{" "}
              {str(time[3], "секунда", "секунды", "секунд")}
            </div>
          </>
        )}
      </div>
      {/* <div className="exlight">https://github.com/only-exlight</div> */}
    </div>
  );
};

export default App;
